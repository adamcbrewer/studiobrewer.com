/*!
ICanHaz.js version 0.10 -- by @HenrikJoreteg
More info at: http://icanhazjs.com
*/(function(){var e=function(){function o(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return s[e]||e})}var e=Object.prototype.toString;Array.isArray=Array.isArray||function(t){return e.call(t)=="[object Array]"};var t=String.prototype.trim,n;if(t)n=function(e){return e==null?"":t.call(e)};else{var r,i;if(/\S/.test("Â ")){r=/^[\s\xA0]+/;i=/[\s\xA0]+$/}else{r=/^\s+/;i=/\s+$/}n=function(e){return e==null?"":e.toString().replace(r,"").replace(i,"")}}var s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},u={},a=function(){};a.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(e,t,n,r){if(!r){this.context=t;this.buffer=[]}if(!this.includes("",e)){if(r)return e;this.send(e);return}e=this.render_pragmas(e);var i=this.render_section(e,t,n);i===!1&&(i=this.render_tags(e,t,n,r));if(r)return i;this.sendLines(i)},send:function(e){e!==""&&this.buffer.push(e)},sendLines:function(e){if(e){var t=e.split("\n");for(var n=0;n<t.length;n++)this.send(t[n])}},render_pragmas:function(e){if(!this.includes("%",e))return e;var t=this,n=this.getCachedRegex("render_pragmas",function(e,t){return new RegExp(e+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+t,"g")});return e.replace(n,function(e,n,r){if(!t.pragmas_implemented[n])throw{message:"This implementation of mustache doesn't understand the '"+n+"' pragma"};t.pragmas[n]={};if(r){var i=r.split("=");t.pragmas[n][i[0]]=i[1]}return""})},render_partial:function(e,t,r){e=n(e);if(!r||r[e]===undefined)throw{message:"unknown_partial '"+e+"'"};return!t||typeof t[e]!="object"?this.render(r[e],t,r,!0):this.render(r[e],t[e],r,!0)},render_section:function(e,t,n){if(!this.includes("#",e)&&!this.includes("^",e))return!1;var r=this,i=this.getCachedRegex("render_section",function(e,t){return new RegExp("^([\\s\\S]*?)"+e+"(\\^|\\#)\\s*(.+)\\s*"+t+"\n*([\\s\\S]*?)"+e+"\\/\\s*\\3\\s*"+t+"\\s*([\\s\\S]*)$","g")});return e.replace(i,function(e,i,s,o,u,a){var f=i?r.render_tags(i,t,n,!0):"",l=a?r.render(a,t,n,!0):"",c,h=r.find(o,t);s==="^"?!h||Array.isArray(h)&&h.length===0?c=r.render(u,t,n,!0):c="":s==="#"&&(Array.isArray(h)?c=r.map(h,function(e){return r.render(u,r.create_context(e),n,!0)}).join(""):r.is_object(h)?c=r.render(u,r.create_context(h),n,!0):typeof h=="function"?c=h.call(t,u,function(e){return r.render(e,t,n,!0)}):h?c=r.render(u,t,n,!0):c="");return f+c+l})},render_tags:function(e,t,n,r){var i=this,s=function(){return i.getCachedRegex("render_tags",function(e,t){return new RegExp(e+"(=|!|>|&|\\{|%)?([^#\\^]+?)\\1?"+t+"+","g")})},u=s(),a=function(e,r,a){switch(r){case"!":return"";case"=":i.set_delimiters(a);u=s();return"";case">":return i.render_partial(a,t,n);case"{":case"&":return i.find(a,t);default:return o(i.find(a,t))}},f=e.split("\n");for(var l=0;l<f.length;l++){f[l]=f[l].replace(u,a,this);r||this.send(f[l])}if(r)return f.join("\n")},set_delimiters:function(e){var t=e.split(" ");this.otag=this.escape_regex(t[0]);this.ctag=this.escape_regex(t[1])},escape_regex:function(e){if(!arguments.callee.sRE){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+t.join("|\\")+")","g")}return e.replace(arguments.callee.sRE,"\\$1")},find:function(e,t){function r(e){return e===!1||e===0||e}e=n(e);var i;if(e.match(/([a-z_]+)\./ig)){var s=this.walk_context(e,t);r(s)&&(i=s)}else r(t[e])?i=t[e]:r(this.context[e])&&(i=this.context[e]);return typeof i=="function"?i.apply(t):i!==undefined?i:""},walk_context:function(e,t){var n=e.split("."),r=t[n[0]]!=undefined?t:this.context,i=r[n.shift()];while(i!=undefined&&n.length>0){r=i;i=i[n.shift()]}return typeof i=="function"?i.apply(r):i},includes:function(e,t){return t.indexOf(this.otag+e)!=-1},create_context:function(e){if(this.is_object(e))return e;var t=".";this.pragmas["IMPLICIT-ITERATOR"]&&(t=this.pragmas["IMPLICIT-ITERATOR"].iterator);var n={};n[t]=e;return n},is_object:function(e){return e&&typeof e=="object"},map:function(e,t){if(typeof e.map=="function")return e.map(t);var n=[],r=e.length;for(var i=0;i<r;i++)n.push(t(e[i]));return n},getCachedRegex:function(e,t){var n=u[this.otag];n||(n=u[this.otag]={});var r=n[this.ctag];r||(r=n[this.ctag]={});var i=r[e];i||(i=r[e]=t(this.otag,this.ctag));return i}};return{name:"mustache.js",version:"0.4.0",to_html:function(e,t,n,r){var i=new a;r&&(i.send=r);i.render(e,t||{},n);if(!r)return i.buffer.join("\n")}}}();(function(){function t(e){return"".trim?e.trim():e.replace(/^\s+/,"").replace(/\s+$/,"")}var n={VERSION:"0.10",templates:{},$:typeof window!="undefined"?window.jQuery||window.Zepto||null:null,addTemplate:function(t,r){if(typeof t=="object"){for(var i in t)this.addTemplate(i,t[i]);return}if(n[t])console.error("Invalid name: "+t+".");else if(n.templates[t])console.error('Template "'+t+'  " exists');else{n.templates[t]=r;n[t]=function(r,i){r=r||{};var s=e.to_html(n.templates[t],r,n.templates);return n.$&&!i?n.$(s):s}}},clearAll:function(){for(var e in n.templates)delete n[e];n.templates={}},refresh:function(){n.clearAll();n.grabTemplates()},grabTemplates:function(){var e,r=document.getElementsByTagName("script"),i,s=[];for(e=0,l=r.length;e<l;e++){i=r[e];if(i&&i.innerHTML&&i.id&&(i.type==="text/html"||i.type==="text/x-icanhaz")){n.addTemplate(i.id,t(i.innerHTML));s.unshift(i)}}for(e=0,l=s.length;e<l;e++)s[e].parentNode.removeChild(s[e])}};typeof require!="undefined"?module.exports=n:window.ich=n;typeof document!="undefined"&&(n.$?n.$(function(){n.grabTemplates()}):document.addEventListener("DOMContentLoaded",function(){n.grabTemplates()},!0))})()})();